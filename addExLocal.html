<!DOCTYPE html>
<html>

	<head>
		<title>添加Gmail附件</title>
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link rel='stylesheet' type='text/css' href='css/bootstrap.css'>
		<script src='js/jquery-1.11.1.min.js'>
	</script>
		<script src='js/bootstrap.js'>
	</script>
		<style type='text/css'> 
	body {
		background-color: #FFF;
	}
	
	caption {
		color: #000;
	}
	</style>

	<script>
		
		Array.prototype.indexOf = function(val) {
        for (var i = 0; i < this.length; i++) {
            if (this[i] == val) return i;
        }
        return -1;
    };
    Array.prototype.remove = function(val) {
        var index = this.indexOf(val);
        if (index > -1) {
            this.splice(index, 1);
        }
    };
    Array.prototype.contain = function(val) {
        var index = this.indexOf(val);
        if (index > -1) {
        	return(1);
        }
        else {
        	return(-1);
        }
    };
		
		function attarr(msgId, filename, url, partId) {   
			this.msgId = msgId;   
			this.filename = filename;   
			this.url = url; 
			this.partId = partId; 
		}  
		
		var attach=[new attarr(1, "附件1", "www.dfdfe.com/dfefe.txt", 4), new attarr(2, "附件2", "www.ererer.com/dfer.doc", 8)];
		var selected = new Array();
		
		function addAtt(att){
		  var searchTable=document.getElementById('attTable');
		  var row=searchTable.insertRow();
		  var c0=row.insertCell(0);
		  var c1=row.insertCell(1);
		  var c2=row.insertCell(2);
		  var c3=row.insertCell(3);
		  var c4=row.insertCell(4);
		  c0.innerHTML="<input type='checkbox' name='attCheck' />";
		  c1.innerHTML=att.msgId;
		  c2.innerHTML=att.filename;
		  c3.innerHTML=att.url;
		  c4.innerHTML=att.partId;
	  }
	  
	  function addSel(att){
		  var searchTable=document.getElementById('selectTable');
		  var row=searchTable.insertRow();
		  var c0=row.insertCell(0);
		  var c1=row.insertCell(1);
		  var c2=row.insertCell(2);
		  var c3=row.insertCell(3);
		  var c4=row.insertCell(4);
		  c0.innerHTML="<input type='checkbox' name='selCheck' />";
		  c1.innerHTML=att.msgId;
		  c2.innerHTML=att.filename;
		  c3.innerHTML=att.url;
		  c4.innerHTML=att.partId;
	  }
		
		function showAtt() {
			var inf;
			if (document.getElementById("attTable").rows.length > 1)
				return;
			for (var i = 0; i < attach.length; i++) {
				//selected.push(attach[i].msgId);
				addAtt(attach[i]);
			}
		}
  	
  	function addSeclet() {
  		var flag=0;
   		var selectTable=document.getElementById('selectTable');
   		var ch=document.getElementsByName('attCheck');
   		for(i=0;i<ch.length;i++){
	    	var tr=ch[i].parentNode.parentNode;
		    var index=tr.rowIndex;
		    if(ch[i].checked==true){
			    if (selected.contain(attach[index - 1].msgId) == -1) {
				    addSel(attach[index - 1]);
				    selected.push(attach[i].msgId);
				  }
			    //alert(selected);
			    //tb.deleteRow(index);
			    flag++;
		    }
	   	}
		   if(flag<=0){
		    alert("请选定要添加的附件！");
		   }
  	}
  	
  	function deleteSelect(){
		  var flag=0;
   		var selectTable=document.getElementById('selectTable');
   		//alert(selectTable);
   		var ch=document.getElementsByName('selCheck');
   		//alert(ch);
   		for(i=ch.length-1;i>=0;i--){
	    	var tr=ch[i].parentNode.parentNode;
		    var index=tr.rowIndex;
		    if(ch[i].checked==true){
			    //alert(selectTable.rows[index].cells[1].innerHTML);
			    selected.remove(selectTable.rows[index].cells[1].innerHTML);
			    selectTable.deleteRow(index);
			    flag++;
		    }
		    //alert(selected);
	   	}
		   if(flag<=0){
		    alert("请选定要删除的附件！");
		   }
 	 	}
  	
	</script>

	</head>

	<body>
		
		<br/>
		<br/>
		<br/>
		
		<div class="row" style="margin:0px auto; width:600px; height:500px; border:2px solid gray; overflow:auto">
					
					<div class="modal-footer" style="background-color:white;">
					
						<div>
							
							<div class='span3 sidebar'>
								<h2>
									·附件来源
								</h2>
								<select class="multiselect" multiple="multiple">
	
									<option value="in">
										收件箱
									</option>
	
									<option value="out">
										发件箱
									</option>
	
									<option value="un">
										垃圾箱
									</option>
	
								</select>
							</div>
							
							<div class='span3 sidebar'>
								<h2>
									·附件搜索
								</h2>
								<form class="form-search">
									<div class="input-append">
										<input type="text" value="要搜索的附件..." class="span2">
										<button type="submit"
											class="btn btn-primary btn-middle btn-danger">
											搜索
										</button>
									</div>
								</form>
	
							</div>
							
						</div>

						<div class="container-fluid" id="exArea">

							<div id="ex">
								
								<table class="table table-hover table-bordered"
									pa_ui_name="table,exinput" pa_ui_hover="true"
									pa_ui_selectable="true" pa_ui_select_mode="multi"
									pa_ui_select_trigger="tr" pa_ui_select_column="0"
									pa_ui_select_triggerelement=":checkbox" id="attTable">
									<caption>
										<h3>
											·附件列表
										</h3>
									</caption>
									<thead>
										<tr>
											<th>
												选择
											</th>
											<th>
												msgId
											</th>
											<th>
												文件名
											</th>
											<th>
												url
											</th>
											<th>
												partId
											</th>
										</tr>
									</thead>
									<tbody>
										
									</tbody>
								</table>

								<div class="pagination"
									style="margin: auto; width: 480px; text-align: center;">
									<ul>
										<li>
											<a href="#" style="color: white; background-color: #ee5f5b;">Prev</a>
										</li>
										<li>
											<a href="#" style="color: blue;">1</a>
										</li>
										<li>
											<a href="#" style="color: red;">2</a>
										</li>
										<li>
											<a href="#" style="color: yellow;">3</a>
										</li>
										<li>
											<a href="#" style="color: blue;">4</a>
										</li>
										<li>
											<a href="#" style="color: green;">5</a>
										</li>
										<li>
											<a href="#" style="color: white; background-color: #ee5f5b;">Next</a>
										</li>
									</ul>
								</div>

								<div class="btn-group"
									style="margin: auto; text-align: right;">
									<button class="btn btn-primary btn-middle btn-danger" onclick="showAtt();">
										显示
									</button>
									<button class="btn btn-primary btn-middle btn-danger" onclick="addSeclet();">
										添加选中附件
									</button>
								</div>

							</div>

						</div>

					</div>
			
					<div class="modal-footer">
						
						<div class="container-fluid">
								
							<div>
								
								<table class="table table-hover table-bordered"
									pa_ui_name="table,exinput" pa_ui_hover="true"
									pa_ui_selectable="true" pa_ui_select_mode="multi"
									pa_ui_select_trigger="tr" pa_ui_select_column="0"
									pa_ui_select_triggerelement=":checkbox" id="selectTable">
									<caption>
										<h3>
											·选中附件列表
										</h3>
									</caption>
									<thead>
										<tr>
											<th>
												选择
											</th>
											<th>
												msgId
											</th>
											<th>
												文件名
											</th>
											<th>
												url
											</th>
											<th>
												partId
											</th>
										</tr>
									</thead>
									<tbody>
										
									</tbody>
								</table>

								<div class="btn-group"
									style="margin: auto; text-align: right;">
									<button class="btn btn-primary btn-middle btn-danger" id="deleteEx" onclick="deleteSelect();">
										删除选中附件
									</button>
									<button class="btn btn-primary btn-middle btn-danger" id="submitModal" onclick="submitModal();">
										确认
									</button>
								</div>
								
							</div>
						</div>

					</div>
				
			
		</div>

	</body>
</html>